{"config":{"lang":["en"],"separator":"[\\s\\u200b\\-_,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"OSIPI ASL Toolbox","text":"<p>A curated library of open-source functions for Arterial Spin Labeling (ASL) perfusion MRI preprocessing and analysis, developed by OSIPI Task Force 2.2.</p>"},{"location":"#contributing-toolboxes","title":"Contributing Toolboxes","text":"<ul> <li>ASLtbx &amp; DL-ASL \u2014 University of Maryland</li> <li>ASL-MRICloud \u2014 Johns Hopkins University</li> <li>BASIL &amp; Oxford-ASL \u2014 University of Oxford / Nottingham</li> <li>ExploreASL \u2014 exploreASL.org</li> <li>DeepASL \u2014 Technical University of Munich</li> <li>Preclinical ASL \u2014 Multi-site contributions</li> </ul>"},{"location":"#documentation","title":"Documentation","text":"<p>Browse the sidebar for function documentation organized by processing step, from motion correction through CBF quantification to deep learning denoising.</p>"},{"location":"additional_tools/","title":"Any additional functionalities with appropriate description","text":""},{"location":"additional_tools/#function-name-asl_calculatediffmap","title":"Function name: <code>ASL_calculateDiffMap</code>","text":"<ul> <li>Description: Calculate difference map and write out the .img/.hdr files</li> <li>Inputs: <code>path_temp</code>, <code>asl_paras</code></li> <li>Outputs: difference image and header files</li> <li>Syntax: <code>ASL_calculateDiffMap(path_temp,asl_paras)</code></li> </ul>"},{"location":"brain_extraction/","title":"Brain extraction/skull stripping","text":""},{"location":"brain_extraction/#function-name-asltbx_createbrainmaskm","title":"Function name: <code>ASLtbx_createbrainmask.m</code>","text":"<ul> <li>Description: use a single threshold to extract the brain, can manually change the threshold by the user</li> <li>Inputs: full path to the input image as <code>P='C:\\Users\\...\\M02.nii';</code></li> <li>Outputs: a brain mask file named 'brainmask.nii' with the same path as input</li> <li>Syntax: <code>maskimg=ASLtbx_createbrainmask(P)</code></li> </ul> <p>Notes</p> <p>This file needs modification: It seems <code>spm_write_vol</code> cannot write the mask well when the mask is only 0 and 1. Added several lines for modification.</p>"},{"location":"brain_extraction/#function-name-batch_create_maskm","title":"Function name: <code>batch_create_mask.m</code>","text":"<ul> <li>Description: Use a single threshold to extract the brain region, can manually change the threshold by the user</li> <li>Inputs: full path to the input image as <code>PF='C:\\Users\\...\\M02.nii';</code></li> <li>Outputs: a brain mask file named 'mask_perf_cbf.img' with the same path as input</li> <li>Syntax:</li> </ul> <p>Notes</p> <p>This script seems to be one code from a whole pipeline. Therefore, there is dependency on passing the file path and subjects. But if we only took the core code for the test, this function is the same as the previous function . And need the same modification as in previous script.</p>"},{"location":"brain_extraction/#function-name-asl_getbrainmaskm","title":"Function name: <code>ASL_getBrainMask.m</code>","text":"<ul> <li>Description: motion correction</li> <li>Inputs: <code>imgtpm</code>, <code>imgfile</code>, <code>flag_addrealignmsk</code></li> <li>Outputs: two masks are generated: <code>brnmsk_dspl</code> (datatype, logical), used for cbf map display; <code>brnmsk_clcu</code> (datatype, logical), used for glo_cbf calculation.</li> <li>Syntax: <code>[brnmsk_dspl, brnmsk_clcu] = ASL_getBrainMask(imgtpm,imgfile,flag_addrealignmsk)</code></li> </ul>"},{"location":"cbf_quantification/","title":"Cerebral Blood Flow (CBF) quantification (please specify the model used)","text":""},{"location":"cbf_quantification/#function-name-asl_perf_subtractm-asl_perf_subtractmbm","title":"Function name: <code>asl_perf_subtract.m</code> / <code>asl_perf_subtractMB.m</code>","text":"<ul> <li>Description: For CASL and PASL, generate the difference and calculate the perfusion images from control/label and M0 images</li> <li>Inputs: Please see the description in the MATLAB code for detailed information.</li> <li>Outputs: Will output CBF maps into the path you defined</li> <li>Syntax: One example for PASL quantification. Both <code>P</code> and <code>M0img</code> are paths for control/label and M0 images: <code>FAIR='C:\\Users\\...\\FAIR_CL.nii'</code>.     <pre><code>perfnum =  asl_perf_subtract(FAIR,1, 0, 0, [0 0 1 0 0 1 0 1 0 0], ...\n                             0.5, 0, 0.9, 1, 2, 0.8, 45, 20, M0img);\nperfnum =  asl_perf_subtractMB(FAIR,1, 0, 0, [0 0 1 0 0 1 0 1 0 0], ...\n                             0.5, 0, 0.9, 1, 2, 0.8, 45, 20, M0img);\n</code></pre></li> </ul>"},{"location":"cbf_quantification/#function-name-aslquantificationpcaslm","title":"Function name: <code>ASLQuantificationPCASL.m</code>","text":"<ul> <li>Description: For pCASL, calculate the perfusion maps with difference images, M0 and related parameters according to the 2015 ASL white paper</li> <li>Inputs: <code>data</code>, <code>M0</code> and <code>mask</code> should be the matrix for pCASL difference, proton density and brain mask images</li> <li>Outputs: Will generate CBF maps in MATLAB workspace</li> <li>Syntax: <code>[output, output_nantmean, NANCOUNTMASK] = ASLQuantificationPCASL(data, M0, 1.8, 1.8,1.6, 0.9, 0.6,'no','',14, 1, mask, 'yes', 'yesfigure');</code></li> </ul> <p>Notes</p> <p>This script needs small modification as shown in the script.</p>"},{"location":"cbf_quantification/#function-name-batch_calc_rcbfm","title":"Function name: <code>batch_calc_rcbf.m</code>","text":"<ul> <li>Description: Calculate the normalized perfusion maps divided by the mean flow</li> <li>Inputs: Choose perfusion maps and mask in the pop out windows</li> <li>Outputs: Will generate normalized CBF maps in same path as original CBF maps</li> <li>Syntax: Just run the whole script, no function to call.</li> </ul> <p>Notes</p> <p>This script seems to be one code from a whole pipeline. Therefore, there is dependency on passing the file path and subjects with spm batch system. But can use the core code lines as a separate function.</p>"},{"location":"cbf_quantification/#function-name-asldeltamm","title":"Function name: <code>ASLDeltaM.m</code>","text":"<ul> <li>Description: Calculate the difference images from the control and label images</li> <li>Inputs: <code>CTRL</code> and <code>TAG</code> are matrix values from the control and label images of ASL images, <code>method</code> can be any value as shown in the script</li> <li>Outputs: Output will be a matrix for difference images in MATLAB workspace</li> <li>Syntax: <code>Output=ASLDeltaM(CTRL,TAG,'PairWise');</code></li> </ul>"},{"location":"cbf_quantification/#function-name-batch_perf_subtractm","title":"Function name: <code>batch_perf_subtract.m</code>","text":"<ul> <li>Description: batch file for the same function as <code>asl_perf_subtract.m</code></li> </ul>"},{"location":"cbf_quantification/#function-name-asl_calculatecbfmapm","title":"Function name: <code>ASL_calculateCBFmap.m</code>","text":"<ul> <li>Description: This function obtains CBF value in the unit of ml/100g/min</li> <li>Inputs: <code>path_temp</code>: the paths of the ASL images, <code>asl_paras</code>: the parameters of the ASL images</li> <li>Outputs: a CBF map in <code>.img</code> format is created in the specified path</li> <li>Syntax: <code>ASL_calculateCBFmap(path_temp,asl_paras)</code></li> </ul> <p>Notes</p> <p>The images are in <code>.img</code> format, instead of dicom or nifti.</p>"},{"location":"co_registration/","title":"Co-registration of ASL images to high resolution T1-weighted, T2-weighted, and/or FLAIR images","text":""},{"location":"co_registration/#function-name-asltbx_spmcoregm","title":"Function name: <code>ASLtbx_spmcoreg.m</code>","text":"<ul> <li>Description: using spm for registering source and allimgs to target.</li> <li>Inputs: <code>target</code>, <code>source</code>, <code>allimgs</code></li> <li>Outputs: co-registered images</li> <li>Syntax: <code>[output]=ASLtbx_spmcoreg(target, source, allimgs)</code></li> </ul>"},{"location":"co_registration/#function-name-asl_coreg","title":"Function name: <code>ASL_coreg</code>","text":"<ul> <li>Description: coregister source to target and apply transform matrix to source and varargin</li> <li>Inputs: <code>target</code>, <code>source</code>, <code>varargin</code></li> <li>Outputs: co-registered images and transformation matrix</li> <li>Syntax: <code>ASL_coreg(target,source,varargin)</code></li> </ul>"},{"location":"co_registration/#function-name-spm_reslice_yli","title":"Function name: <code>spm_reslice_yli</code>","text":"<ul> <li>Description: similar to spm_reslice, does co-registration</li> <li>Inputs: <code>P</code> - matrix or cell array of filenames flags - a structure containing various options.</li> <li>Outputs: co-registered image files to the same subdirectory with a prefix.</li> <li>Syntax: <code>spm_reslice_yli(P,flags)</code></li> </ul>"},{"location":"deep_learning/","title":"Deep learning-based method (Any application relevant to ASL)","text":""},{"location":"deep_learning/#file-name-test_adni_w_ft_0630py","title":"File name: <code>test_ADNI_w_ft_0630.py</code>","text":"<ul> <li>Description: Denoise ASL data in ADNI dataset with fine-tuning model presented in \u201cImproving Sensitivity of Arterial Spin Labeling Perfusion MRI in Alzheimer's Disease Using Transfer Learning of Deep Learning-Based ASL Denoising\u201d.</li> <li>Inputs:     To keep the script easy to run we just hard coded the input within the script. There are three inputs you will need to run the script.<ol> <li>A \u201csubjectlist_valid.txt\u201d file with subject name.</li> <li>A directory containing all the subjects that need to be denoised. Each folder in this directory is one subject. In each subject folder, there are three subfolders i.e., \u201cASL\u201d, \u201cANAT\u201d, and \u201cANAT_DL_mask\u201d. \u201cASL\u201d folder contains ASL data in native space. \u201cANAT\u201d folder contains the structural images for preprocessing the data e.g., registration or normalization. \u201cANAT_DL_mask\u201d contains the gray matter, white matter, and the cerebrospinal fluid.</li> <li>A trained deep learning model.</li> </ol> </li> <li>Outputs: Denoised ASL data in each subject\u2019s \u201cASL\u201d folder.</li> <li>Syntax: <code>python test_ADNI_w_ft_0630.py</code></li> </ul>"},{"location":"deep_learning/#file-name-test_adni_w_direct_ft_0630py","title":"File name: <code>test_ADNI_w_Direct_FT_0630.py</code>","text":"<ul> <li>Description: Denoise ASL data in ADNI dataset with direct transfer learning model presented in \u201cImproving Sensitivity of Arterial Spin Labeling Perfusion MRI in Alzheimer's Disease Using Transfer Learning of Deep Learning-Based ASL Denoising\u201d. The main difference between this script and \u201ctest_ADNI_w_ft_0630.py\u201d is that the models used for denoising are different.</li> <li>Inputs:     To keep the script easy to run we just hard coded the input within the script. There are three inputs you will need to run the script.<ol> <li>A \u201csubjectlist_valid.txt\u201d file with subject name.</li> <li>A directory containing all the subjects that need to be denoised. Each folder in this directory is one subject. In each subject folder, there are three subfolders i.e., \u201cASL\u201d, \u201cANAT\u201d, and \u201cANAT_DL_mask\u201d. \u201cASL\u201d folder contains ASL data in native space. \u201cANAT\u201d folder contains the structural images for preprocessing the data e.g., registration or normalization. \u201cANAT_DL_mask\u201d contains the gray matter, white matter, and the cerebrospinal fluid.</li> <li>A trained deep learning model.</li> </ol> </li> <li>Outputs: Denoised ASL data in each subject\u2019s \u201cASL\u201d folder.</li> <li>Syntax: <code>python test_ADNI_w_Direct_FT_0630.py</code></li> </ul>"},{"location":"deep_learning/#function-name-read_subject_list","title":"Function name: <code>read_subject_list</code>","text":"<ul> <li>Description: This is a helper function used in \u201ctest_ADNI_w_Direct_FT_0630.py\u201d and \u201ctest_ADNI_w_ft_0630.py\u201d. The function is used to read the subject list in a \u201c.txt\u201d file.</li> <li>Inputs: A \u201c.txt\u201d file with each line denotes a subject name.</li> <li>Outputs: A list of all subjects.</li> <li>Syntax: <code>content = read_subject_list('subjectlist_valid.txt')</code></li> </ul>"},{"location":"deep_learning/#function-name-get_subj_c123","title":"Function name: <code>get_subj_c123</code>","text":"<ul> <li>Description: This is a helper function used in \u201ctest_ADNI_w_Direct_FT_0630.py\u201d and \u201ctest_ADNI_w_ft_0630.py\u201d. The function is used to get the gray matter, white matter, and the cerebrospinal fluid of each subject.</li> <li>Inputs: A subject name and a folder containing the subject name.</li> <li>Outputs: A mask with the gray matter, the white matter, and the cerebrospinal fluid.</li> <li>Syntax: <code>mask = get_subj_c123(subject_name, folder_name)</code></li> </ul>"},{"location":"deep_learning/#function-name-parse_args","title":"Function name: <code>parse_args</code>","text":"<ul> <li>Description: Parser for command-line options, arguments and sub-commands. The function is used to set up the deep learning model\u2019s folder and name.</li> <li>Inputs: A directory of the deep learning model and the model\u2019s file name.</li> <li>Outputs: An instance of the parser.</li> <li>Syntax: <code>args = parse_args()</code></li> </ul>"},{"location":"deep_learning/#function-name-predict_nii_w_masks_rbk","title":"Function name: <code>predict_nii_w_masks_rbk</code>","text":"<ul> <li>Description: The function is used to denoise all the subjects\u2019 ASL data within a folder by using a deep learning model.</li> <li>Inputs: A deep learning model, the root folder of all subjects, and the name of the denoised results.</li> <li>Outputs: Denoised results.</li> <li>Syntax: <code>predict_nii_w_masks_rbk(model,root_folder,save_name)</code></li> </ul>"},{"location":"denoising/","title":"Outlier removal or Denoising","text":""},{"location":"denoising/#function-name-asltbx_aoc","title":"Function name: <code>ASLtbx_aoc</code>","text":"<ul> <li>Description: It adaptively removes CBF volumes from the CBF time series and averages the remaining volume to obtain the meanCBF map. The removal is based on estimated motion, and correlation between individual CBF volumes and mean CBF map. Algorithm based on https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3777751/</li> <li>Inputs: CBF time series and optionally: text file with the estimated motion parameters realigning the raw ASL time series, brain mask in the ASL space, an algorithm specific threshold parameter (default 0.17) and number of iterations (default 2)</li> <li>Outputs: Outlier volume numbers. Also generates the estimated CBF map obtained after outlier removal.</li> <li>Syntax: <pre><code>ASLtbx_aoc(cbfimgs, motionfile, maskimg, th, iter)\n</code></pre>     See the help section of the code for details.     Use the <code>batch_outlier_clean</code> to call the function</li> </ul>"},{"location":"denoising/#function-name-asltbx_aocsl","title":"Function name: <code>ASLtbx_aocSL</code>","text":"<ul> <li>Description: It adaptively removes slices from CBF volumes in the CBF time series and averages the remaining slices and volumes to obtain the mean CBF map. Algorithm is based on https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3777751/</li> <li>Inputs: CBF time series, <code>c1img</code> and <code>c2img</code> (GM and WM tissue probability maps obtained from SPM segmentation of high resolution T1 image, coregistered and downsampled to the ASL space), <code>masking</code> (brain mask in the ASL space), <code>th</code> (a threshold parameter, default =0.17, better to not change), <code>motionfile</code> (test file with the estimated motion parameters realigning the raw ASL time series)</li> <li>Outputs: <code>oidx</code>: identified outliers. Also generates the estimated CBF map obtained after outlier removal.</li> <li>Syntax: <code>ASLtbx_aocSL(cbfimgs, c1img, c2img, maskimg, th, motionfile)</code></li> </ul>"},{"location":"denoising/#function-name-batch_score_cleanm","title":"Function name: <code>batch_SCORE_clean.m</code>","text":"<ul> <li>Description: Calculate</li> <li>Inputs: The path of perfusion maps, GM, WM and CSF Probability maps.</li> <li>Outputs: Will</li> <li>Syntax: Just run the whole script, no function to call. But does need to include the <code>SCORE_denoising.m</code> function.</li> </ul> <p>Notes</p> <p>This script seems to be one code from a whole pipeline. Therefore, there is dependency on passing the file path and subjects with spm batch system. But can use the core code lines as a separate function.</p>"},{"location":"motion_correction/","title":"Motion Correction","text":""},{"location":"motion_correction/#function-name-batch_realignm","title":"Function name: <code>batch_realign.m</code>","text":"<ul> <li>Description: realigns raw EPI images using SPM realignment tools</li> <li>Inputs: 4D NIfTI</li> <li>Outputs: This script seems to be one code from a whole pipeline. Therefore, there is dependency on passing the file path and subjects.</li> <li>Syntax: DNA</li> </ul>"},{"location":"motion_correction/#function-name-asl_realignm","title":"Function name: <code>ASL_realign.m</code>","text":"<ul> <li>Description: motion correction</li> <li>Inputs: <code>path_temp</code>: the path of the ASL image, <code>name_asl</code>:name of the ASL image</li> <li>Outputs: Generates realigned images from the time series</li> <li>Syntax: <code>P = ASL_realign(path_temp, name_asl)</code></li> </ul>"},{"location":"normalization/","title":"Normalization to common template (e.g., MNI space)","text":""},{"location":"normalization/#function-name-asltbx_spm12normest","title":"Function name: <code>ASLtbx_spm12normest</code>","text":"<ul> <li>Description: Normalize the structural image to the standard template (TPM.nii) using spm12 functions.</li> <li>Inputs: <code>strucimg</code> should be paths of the target structural images</li> <li>Outputs: normalized structural images in the assigned folder</li> <li>Syntax: <code>ASLtbx_spm12normest(strucimg)</code></li> </ul> <p>Notes</p> <p>The whole script runs fine, however, the normalized image is black and white.</p>"},{"location":"normalization/#function-name-asltbx_spm12normest_1","title":"Function name: <code>ASLtbx_spm12normest</code>","text":"<ul> <li>Description: Normalize the structural image to the standard template (TPM.nii) using spm12 functions.</li> <li>Inputs: <code>strucimg</code> should be paths of the target structural images</li> <li>Outputs: normalized structural images in the assigned folder</li> <li>Syntax: <code>ASLtbx_spm12normest(strucimg)</code></li> </ul> <p>Notes</p> <p>The whole script runs fine, however, the normalized image is black and white.</p>"},{"location":"roi_creation/","title":"Create ROIs","text":""},{"location":"roi_creation/#function-name-roipolym","title":"Function name: <code>roipoly.m</code>","text":"<ul> <li>Description: selects a polygonal region of interest within an image, this function should be similar to MATLAB\u2019s built-in function \u201croipoly\u201d.</li> <li>Inputs: A 2D image file name</li> <li>Outputs: returns a binary image that can be used as a mask for masked filtering, returns the polygon coordinates</li> <li>Syntax: <code>[BW, xi, yi] = roipoly(\u2018image.jpeg\u2019);</code></li> </ul>"},{"location":"segmentation/","title":"Segmentation of high-resolution images (Grey Matter and White Matter)","text":""},{"location":"segmentation/#function-name-asltbx_spmnsegment","title":"Function name: <code>ASLtbx_spmnsegment</code>","text":"<ul> <li>Description: Probabilistically segment the high resolution T1 images</li> <li>Inputs: High resolution T1 image</li> <li>Outputs: Probabilistic segmentations of GM, WM and CSF (file names starting with <code>c1</code>, <code>c2</code> and <code>c3</code>)</li> <li>Syntax: <code>ASLtbx_spmnsegment(full_path_of_T1_Image)</code></li> </ul>"},{"location":"smoothing/","title":"Smoothing","text":""},{"location":"smoothing/#function-name-asltbx_smoothing","title":"Function name: <code>ASLtbx_smoothing</code>","text":"<ul> <li>Description: smoothes an image, returns the smoothed image</li> <li>Inputs: image path, and a kernel size</li> <li>Outputs: smoothed image, written as a different file</li> <li>Syntax: <code>ASLtbx_smoothing(\u2018image.nii\u2019, 2)</code></li> </ul>"},{"location":"smoothing/#function-name-batch_smooth_wconfile-and-batch_smooth","title":"Function name: <code>batch_smooth_wconfile</code> and <code>batch_smooth</code>","text":"<ul> <li>Description: A code from pipeline. Needs dependency from the spm batch. It uses spm_smooth to smooth a number of files.</li> <li>Inputs: path of the images</li> <li>Outputs: smoothed images</li> <li>Syntax: As this is part of the pipeline, just run the script, no function to call</li> </ul>"}]}